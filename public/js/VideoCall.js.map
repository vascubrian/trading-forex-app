{"version":3,"sources":["utils/index.js","VideoCall.js"],"names":["parseJwt","base64Url","base64","document","querySelector","getAttribute","split","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","checkUsersOnline","sessionData","userEmail","userStatus","stringify","indexOf","checkFileAttachment","messageBody","fileName","autoFileName","checkFileExtension","test","pop","startPlaySound","smsNumbers","parseInt","playNotificationSound","audioFile","Audio","play","videoCheckUser","textObject","$","loggedUser","videoReceiverFullName","val","videoReceiverEmail","click","event","preventDefault","window","close","setTimeout","html","jQuery"],"mappings":";AA4DC,aA5DM,SAASA,IACRC,IACAC,EADYC,SAASC,cAAc,yBAAyBC,aAAa,WAAWC,MAAM,KAAK,GAC5EC,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KACpDC,EAAcC,mBAAmBC,KAAKR,GAAQI,MAAM,IAAIK,IAAI,SAAUC,GACnE,MAAA,KAAO,KAAOA,EAAEC,WAAW,GAAGC,SAAS,KAAKC,OAAO,KACzDC,KAAK,KACDC,OAAAA,KAAKC,MAAMV,GAGb,SAASW,EAAkBC,EAAaC,GACzCC,IAAAA,EAAaL,KAAKC,MAAM,6DAKrBI,OAJYL,KAAKM,UAAUH,GACnBI,QAAQ,MAAQH,EAAY,QAAU,IACnDC,EAAaL,KAAKC,MAAM,6DAEnBI,EAGF,SAASG,EAAqBC,EAAaC,EAAUC,GAEtDF,MAAgB,kBAAhBA,IAAoE,IAAjCG,EAAmBF,GACdC,mCAAAA,OAAAA,EAA1C,4BACyB,kBAAhBF,EACyDE,2DAAAA,OAAAA,EAAiBD,MAAAA,OAAAA,EAAnF,QAJa,+aAKGG,KAAKJ,GACFA,YAAAA,OAAAA,EAAwDA,8CAAAA,OAAAA,EAA3E,QAEOA,EAIX,SAASG,EAAoBF,GACvBA,MAA8B,QAA9BA,EAASrB,MAAM,KAAKyB,OAAiD,QAA9BJ,EAASrB,MAAM,KAAKyB,OAAiD,SAA9BJ,EAASrB,MAAM,KAAKyB,OAAkD,QAA9BJ,EAASrB,MAAM,KAAKyB,OAAiD,QAA9BJ,EAASrB,MAAM,KAAKyB,MAOhL,SAASC,EAAgBC,GAC1BC,OAAAA,SAASD,GAAc,GACzBE,EAAsB,aACfF,GAEA,GAIJ,SAASE,EAAuBC,GACvB,IAAIC,MAAM,UAAYD,GAC9BE,OAGD,SAASC,EAAgBnB,EAAaC,GAEvCmB,OADevB,KAAKM,UAAUH,GACnBI,QAAQ,MAAQH,EAAY,QAAU,EAKtD,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,SAAA,EAAA,QAAA,iBAAA,EAAA,QAAA,oBAAA,EAAA,QAAA,eAAA,EAAA,QAAA,sBAAA,EAAA,QAAA,eAAA;;AC3DD,aADA,IAAA,EAAA,QAAA,kBACA,SAAWoB,GAGL,IADFC,GACE,EAHQ,EAAA,YAEVA,WAGIC,EAAwBF,EAAE,0BAA0BG,MACpDC,EAAqBJ,EAAE,uBAAuBG,MAEpDH,EAAE,mBAAmBK,MAAM,SAAUC,GACnCA,EAAMC,iBACNC,OAAOC,WAGa,EAAA,EAAA,uBAAA,kBACtBC,WACE,YACyD,KAAnD,EAAeT,EAAAA,gBAAAA,EAAYG,GAC7BJ,EAAE,yBAAyBW,KAAK,WAAaT,IAE7CF,EAAE,yBAAyBW,KAAK,WAAaT,GAE7CQ,WAAW,WACTF,OAAOC,SACN,OAEJ,KAzBP,CA0BGG","file":"VideoCall.js","sourceRoot":"../src","sourcesContent":["export function parseJwt () {\n  const base64Url = document.querySelector('meta[name=\"apiToken\"]').getAttribute('content').split('.')[1];\n  const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n  const jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {\n    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n  }).join(''));\n  return JSON.parse(jsonPayload);\n}\n\nexport function checkUsersOnline (sessionData, userEmail) {\n  var userStatus = JSON.parse('{ \"userStatus\":\"Offline\",\"colorIndicator\":\"text-warning\"}');\n  const textObject = JSON.stringify(sessionData);\n  if (textObject.indexOf('\\\\\"' + userEmail + '\\\\\"') >= 0) {\n    userStatus = JSON.parse('{ \"userStatus\":\"Online\",\"colorIndicator\":\"text-success\"}');\n  }\n  return userStatus;\n}\n\nexport function checkFileAttachment (messageBody, fileName, autoFileName) {\n  const regexp = /^(?:(?:https?|ftp):\\/\\/)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:\\/\\S*)?$/;\n  if (messageBody === 'IMAGE-CHAT-01' && checkFileExtension(fileName) === true) {\n    return `<img src=\"data:image/png;base64,${autoFileName}\" class='chat-image' />`;\n  } else if (messageBody === 'IMAGE-CHAT-01') {\n    return `<a href=\"#\" class=\"file-down chat-link-style\" fileName=\"${autoFileName}\">${fileName}</a>`;\n  } else if (regexp.test(messageBody)) {\n    return `<a href=\"${messageBody}\" target=\"_blank\" class=\"chat-link-style\">${messageBody}</a>`;\n  } else {\n    return messageBody;\n  }\n}\n\nfunction checkFileExtension (fileName) {\n  if (fileName.split('.').pop() === 'jpg' || fileName.split('.').pop() === 'svg' || fileName.split('.').pop() === 'jpeg' || fileName.split('.').pop() === 'png' || fileName.split('.').pop() === 'gif') {\n    return true;\n  } else {\n    return false;\n  }\n}\n// start play sound\nexport function startPlaySound (smsNumbers) {\n  if (parseInt(smsNumbers) > 0) {\n    playNotificationSound('alert.mp3');\n    return smsNumbers;\n  } else {\n    return '';\n  }\n}\n\nexport function playNotificationSound (audioFile) {\n  const audio = new Audio('images/' + audioFile);\n  audio.play();\n}\n\nexport function videoCheckUser (sessionData, userEmail) {\n  const textObject = JSON.stringify(sessionData);\n  if (textObject.indexOf('\\\\\"' + userEmail + '\\\\\"') >= 0) {\n    return true;\n  } else {\n    return false;\n  }\n}\n","import { parseJwt, playNotificationSound, videoCheckUser } from './utils/index';\n(function ($) {\n  const {\n    loggedUser\n  } = parseJwt();\n\n  const videoReceiverFullName = $('#videoReceiverFullName').val();\n  const videoReceiverEmail = $('#videoReceiverEmail').val();\n\n  $('.end-video-call').click(function (event) {\n    event.preventDefault();\n    window.close();\n  });\n\n  playNotificationSound('video-call.mp3');\n  setTimeout(\n    function () {\n      if (videoCheckUser(loggedUser, videoReceiverEmail) === true) {\n        $('.top-receiver-details').html('Ringing ' + videoReceiverFullName);\n      } else {\n        $('.top-receiver-details').html('Offline ' + videoReceiverFullName);\n        // close the panel \n        setTimeout(function () {\n          window.close();\n        }, 5000);\n      }\n    }, 5000);\n})(jQuery);\n"]}