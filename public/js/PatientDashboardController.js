parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"jWsf":[function(require,module,exports) {
"use strict";function t(){var t=document.querySelector('meta[name="apiToken"]').getAttribute("content").split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),e=decodeURIComponent(atob(t).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)}function e(t,e){var n=JSON.parse('{ "userStatus":"Offline","colorIndicator":"text-warning"}');return JSON.stringify(t).indexOf('\\"'+e+'\\"')>=0&&(n=JSON.parse('{ "userStatus":"Online","colorIndicator":"text-success"}')),n}function n(t,e,n){return"IMAGE-CHAT-01"===t&&!0===a(e)?'<img src="data:image/png;base64,'.concat(n,"\" class='chat-image' />"):"IMAGE-CHAT-01"===t?'<a href="#" class="file-down chat-link-style" fileName="'.concat(n,'">').concat(e,"</a>"):/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/.test(t)?'<a href="'.concat(t,'" target="_blank" class="chat-link-style">').concat(t,"</a>"):t}function a(t){return"jpg"===t.split(".").pop()||"svg"===t.split(".").pop()||"jpeg"===t.split(".").pop()||"png"===t.split(".").pop()||"gif"===t.split(".").pop()}function r(t){return parseInt(t)>0?(o("alert.mp3"),t):""}function o(t){new Audio("images/"+t).play()}function s(t,e){return JSON.stringify(t).indexOf('\\"'+e+'\\"')>=0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseJwt=t,exports.checkUsersOnline=e,exports.checkFileAttachment=n,exports.startPlaySound=r,exports.playNotificationSound=o,exports.videoCheckUser=s;
},{}],"PGfa":[function(require,module,exports) {
"use strict";var _index=require("./utils/index");!function($){var _this=this,_parseJwt=(0,_index.parseJwt)(),username=_parseJwt.username,password=_parseJwt.password,urlBase=_parseJwt.urlBase,pageBase=_parseJwt.pageBase,loggedUser=_parseJwt.loggedUser,loggedInUrl=_parseJwt.loggedInUrl,chatLock=0;$("#saveWekebereBelt").click(function(){$(_this).html("Saving");var serialNumber=$("#serialNumber").val(),deviceModel=$("#deviceModel").val(),owner=$("#owner").val(),location=$("#location").val(),facility=$("#facility").val(),registerEmail=$("#registerEmail").val(),$errorMessage=$(".error-message");""===serialNumber||""===deviceModel||""===owner||""===location?($errorMessage.html("All fields are required !!"),$(_this).html("Save")):$.ajax({url:urlBase+"/register-wekebere-belt",method:"POST",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:JSON.stringify({serialNumber:serialNumber,deviceModel:deviceModel,owner:owner,location:location,facility:facility,registerEmail:registerEmail}),success:function(e){window.open("/wekebere-belts","_self")},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));$errorMessage.html(err.message),$(this).html("Save")}})});var $divItemsLoader=$(".div-items-loader"),registerEmail=$("#registerEmail").val();switch(pageBase){case"Pregnant Woman":notificationMessages();break;case"WekebereBelt":$.ajax({url:urlBase+"/list-wekebere-belts",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{registerEmail:registerEmail},success:function(e){$divItemsLoader.empty();for(var a=0;a<e.length;a++)$divItemsLoader.append('<p class="text-gray-500 font-weight-bold border-bottom border-primary">'.concat(e[a].serialNumber,' <span class="float-right"><a href="#" class="wekebere-belt-delete" deleteId="').concat(e[a].id,'"><i class="fas fa-trash-alt"></i></a></span></p>'))},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));$divItemsLoader.append('<p class="text-gray-500 text-denger text-center">'.concat(err.message,"</p>")),$(this).html("Save")}});break;case"PatientChatSelection":chatLock=1,$.ajax({url:urlBase+"/find-by-usertype",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{userType:"Doctor",receiver:$("#registerEmail").val()},success:function(e){$(".inbox_chat").empty();for(var a="",t=0;t<e.length;t++){var s=(0,_index.checkUsersOnline)(loggedUser,e[t].email),r=s.userStatus,c=s.colorIndicator;""===a?($(".inbox_chat").append('\n                <a href="#"  receiverFullName="'.concat(e[t].fullName,'" receiverEmail="').concat(e[t].email,'">\n                  <div class="chat_list active_chat">\n                  <div class="chat_people">\n                    <div class="chat_img"><img src="images/black_doctor.jpg" alt="').concat(e[t].fullName,'"> </div>\n                    <div class="chat_ib">\n                    <h5>').concat(e[t].fullName,' <span class="chat_date ').concat(c,'">').concat(r,' <span class="text-success px-2">').concat((0,_index.startPlaySound)(e[t].alertMessages),"</span></span></h5>\n                    <p>").concat(e[t].facility,"</p>\n                    </div>\n                  </div>\n                  </div>\n                </a>\n                ")),$(".top-chat-header").html(e[t].fullName),$(".msg_video_call").attr("href","/startVideoCall?fullName=".concat(e[t].fullName,"&email=").concat(e[t].email)),a=e[t].email):$(".inbox_chat").append('\n              <a href="#" class="startUserChat" receiverFullName="'.concat(e[t].fullName,'" receiverEmail="').concat(e[t].email,'">\n                <div class="chat_list">\n                <div class="chat_people">\n                  <div class="chat_img"><img src="images/black_doctor.jpg" alt="').concat(e[t].fullName,'"> </div>\n                  <div class="chat_ib">\n                  <h5>').concat(e[t].fullName,' <span class="chat_date ').concat(c,'">').concat(r,' <span class="text-success px-2">').concat((0,_index.startPlaySound)(e[t].alertMessages),"</span></span></h5>\n                  <p>").concat(e[t].facility,"</p>\n                  </div>\n                </div>\n                </div>\n              </a>\n              "))}loadingActiveChat(a),chatLock=0;setInterval(doAjaxCall,1e4)},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));alert(err.message)}})}function loadingActiveChat(receiver){var sender=$("#registerEmail").val();chatLock=1,$("#chatReceiver").val(receiver),$(".msg_history").html('<div class="d-flex justify-content-center"><div class="spinner-border text-primary m-5" role="status"><span class="sr-only">Loading...</span> </div></div>'),$.ajax({url:urlBase+"/find-senderandreceiver",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{sender:sender,receiver:receiver},success:function(e){chatHandler(e,sender)},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));alert(err.message)}})}function searchByFacility(searchFacility,userType){$.ajax({url:urlBase+"/find-by-facility",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{facility:searchFacility,userType:userType},success:function(e){$(".inbox_chat").empty();for(var a="",t=0;t<e.length;t++){var s=(0,_index.checkUsersOnline)(loggedUser,e[t].email),r=s.userStatus,c=s.colorIndicator;""===a?($(".inbox_chat").append('\n              <a href="#" class="startUserChat" receiverFullName="'.concat(e[t].fullName,'" receiverEmail="').concat(e[t].email,'">\n                <div class="chat_list active_chat">\n                <div class="chat_people">\n                  <div class="chat_img"><img src="images/black_doctor.jpg" alt="').concat(e[t].fullName,'"> </div>\n                  <div class="chat_ib">\n                  <h5>').concat(e[t].fullName,' <span class="chat_date ').concat(c,'">').concat(r,"</span></h5>\n                  <p>").concat(e[t].facility,"</p>\n                  </div>\n                </div>\n                </div>\n              </a>\n              ")),$(".top-chat-header").html(e[t].fullName),$(".msg_video_call").attr("href","/startVideoCall?fullName=".concat(e[t].fullName,"&email=").concat(e[t].email)),a=e[t].email):$(".inbox_chat").append('\n            <a href="#" class="startUserChat" receiverFullName="'.concat(e[t].fullName,'" receiverEmail="').concat(e[t].email,'">\n              <div class="chat_list">\n              <div class="chat_people">\n                <div class="chat_img"><img src="images/black_doctor.jpg" alt="').concat(e[t].fullName,'"> </div>\n                <div class="chat_ib">\n                <h5>').concat(e[t].fullName,' <span class="chat_date ').concat(c,'">').concat(r,"</span></h5>\n                <p>").concat(e[t].facility,"</p>\n                </div>\n              </div>\n              </div>\n            </a>\n            "))}loadingActiveChat(a)},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));alert(err.message)}})}function sendChatMessage(messageBody,receiver){var sender=$("#registerEmail").val();$.ajax({url:urlBase+"/save-user-chat",method:"POST",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:JSON.stringify({sender:sender,receiver:receiver,messageBody:messageBody}),success:function(e){chatHandler(e,sender)},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));alert(err.message)}})}function chatHandler(e,a){$(".msg_history").empty();for(var t=0;t<e.length;t++)e[t].sender===a?$(".msg_history").append('\n              <div class="outgoing_msg">\n              <div class="sent_msg">\n                <p>'.concat((0,_index.checkFileAttachment)(e[t].messageBody,e[t].originalFile,e[t].fileName),'</p>\n                <span class="time_date">').concat(e[t].messageTime,"    |    ").concat(moment(e[t].chatTime).format("YYYY-MM-DD"),'    |    <span class ="text-success">').concat(e[t].status,"</span></span> </div>\n              </div>\n            ")):$(".msg_history").append('\n          <div class="incoming_msg">\n            <div class="incoming_msg_img"> <img src="images/black_doctor.jpg" alt="sunil"> </div>\n            <div class="received_msg">\n              <div class="received_withd_msg">\n              <p>'.concat((0,_index.checkFileAttachment)(e[t].messageBody,e[t].originalFile,e[t].fileName),'</p>\n              <span class="time_date">').concat(e[t].messageTime,"    |    ").concat(e[t].chatTime,'    |    <span class ="text-success">').concat(e[t].status,"</span></span></div>\n            </div>\n            </div>\n          "));$(".msg_history").scrollTop($(".msg_history")[0].scrollHeight)}function doAjaxCall(){0===parseInt(chatLock)&&autoChatRefresh($("#chatReceiver").val())}function autoChatRefresh(receiverChat){$.ajax({url:urlBase+"/find-by-usertype",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{userType:"Doctor",receiver:$("#registerEmail").val()},success:function(e){$(".inbox_chat").empty();for(var a=0;a<e.length;a++){var t=(0,_index.checkUsersOnline)(loggedUser,e[a].email),s=t.userStatus,r=t.colorIndicator;$(".inbox_chat").append('\n            <a href="#" class="startUserChat" receiverFullName="'.concat(e[a].fullName,'" receiverEmail="').concat(e[a].email,'">\n              <div class="chat_list">\n              <div class="chat_people">\n                <div class="chat_img"><img src="images/black_doctor.jpg" alt="').concat(e[a].fullName,'"> </div>\n                <div class="chat_ib">\n                <h5>').concat(e[a].fullName,' <span class="chat_date ').concat(r,'">').concat(s,' <span class="text-success px-2">').concat((0,_index.startPlaySound)(e[a].alertMessages),"</span></span></h5>\n                <p>").concat(e[a].facility,"</p>\n                </div>\n              </div>\n              </div>\n            </a>\n            "))}autoActiveChat(receiverChat)},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));console.log(err.message)}})}function autoActiveChat(receiver){var sender=$("#registerEmail").val();$.ajax({url:urlBase+"/find-senderandreceiver",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{sender:sender,receiver:receiver},success:function(e){chatHandler(e,sender)},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));alert(err.message)}})}function notificationMessages(){var sender=$("#registerEmail").val();$.ajax({url:urlBase+"/find-receiver",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{receiver:sender,chatStatus:"sent"},success:function(e){$("#messageCenter").empty();for(var a=0;a<e.length;a++)$("#messageCenter").append('<a class="dropdown-item d-flex align-items-center" href="/patient-chat-selection">\n              <div class="dropdown-list-image mr-3">\n                <img class="rounded-circle" src="images/patient_logo.png" alt="">\n                <div class="status-indicator bg-success"></div>\n              </div>\n              <div class="font-weight-bold">\n                <div class="text-truncate">'.concat((0,_index.checkFileAttachment)(e[a].messageBody,e[a].originalFile,e[a].fileName),'</div>\n                <div class="small text-gray-500">').concat(e[a].sender,"</div>\n              </div>\n          </a>"))},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));alert(err.message)}}),$.ajax({url:urlBase+"/top-dashboard-data",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{registerEmail:sender},success:function(e){$(".countNot").html(e[0].unreadMessages),$(".unread-messages").html(e[0].unreadMessages),$(".belt-data").html(e[0].wekebereBelts),$(".contraction-data").html(e[0].contraction),$(".fhr-data").html(e[0].fhr)},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));alert(err.message)}})}$divItemsLoader.on("click",".wekebere-belt-delete",function(){var deleteId=$(this).attr("deleteId"),registerEmail=$("#registerEmail").val();$.ajax({url:urlBase+"/delete-wekebere-belt",method:"GET",contentType:"application/json",crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},data:{id:deleteId,registerEmail:registerEmail},success:function(e){$divItemsLoader.empty();for(var a=0;a<e.length;a++)$divItemsLoader.append('<p class="text-gray-500 font-weight-bold border-bottom border-primary">'.concat(e[a].serialNumber,' <span class="float-right"><a href="#" class="wekebere-belt-delete" deleteId="').concat(e[a].id,'"><i class="fas fa-trash-alt"></i></a></span></p>'))},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));$divItemsLoader.append('<p class="text-gray-500 text-denger text-center">'.concat(err.message,"</p>"))}})}),$(".inbox_chat").on("click",".startUserChat",function(){var e=$(this).attr("receiverEmail");$(".top-chat-header").html($(this).attr("receiverFullName")),$(".msg_video_call").attr("href","/startVideoCall?fullName=".concat($(this).attr("receiverFullName"),"&email=").concat($(this).attr("receiverEmail"))),$(this).parent().find("div.active_chat").removeClass("active_chat"),$(this).css("background: #e8f6ff;"),chatLock=1,loadingActiveChat(e),chatLock=0}),$("#sendChatMessage").click(function(e){chatLock=1;var a=$("#chatReceiver").val(),t=$("#messageBody").val();""!==t&&(sendChatMessage(t,a),$("#messageBody").val("")),chatLock=0}),$("#searchFacility").keypress(function(e){chatLock=1;var a=e.keyCode?e.keyCode:e.which;if(13===parseInt(a)){var t=$("#searchFacility").val();""!==t&&(searchByFacility(t,"Doctor"),$("#searchFacility").val(""))}chatLock=0}),$("#messageBody").keypress(function(e){chatLock=1;var a=e.keyCode?e.keyCode:e.which;if(13===parseInt(a)){var t=$("#chatReceiver").val(),s=$("#messageBody").val();""!==s&&(sendChatMessage(s,t),$("#messageBody").val(""))}chatLock=0}),$("#uploadIcon").click(function(){$(this).next().trigger("click")}),$("#chatFile").change(function(){var $chatFile=$("#chatFile"),fileSelected=$chatFile.prop("files")[0],$uploadMessage=$(".upload_message"),sender=$("#registerEmail").val(),receiver=$("#chatReceiver").val();if(""!==$chatFile.val()){$uploadMessage.html("Uploading"),$uploadMessage.show();var formData=new FormData;formData.append("attachFile",fileSelected),formData.append("sender",sender),formData.append("receiver",receiver),$.ajax({url:urlBase+"/attach-user-chat",method:"POST",data:formData,crossDomain:!0,xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic ".concat(btoa("".concat(username,":").concat(password))))},processData:!1,contentType:!1,success:function(e){$uploadMessage.html("Success"),$chatFile.val(null),setTimeout(function(){$uploadMessage.hide()},5e3)},error:function error(xhr){var err=eval("(".concat(xhr.responseText,")"));$uploadMessage.html(err.message)}})}}),$(".msg_history").on("click",".file-down",function(){var e=$(this).attr("fileName");window.location.href=loggedInUrl+"/download?fileName=".concat(e)}),$("#startViewVideo").click(function(e){e.preventDefault();var a=$(window).width()/2-450,t=$(window).height()/2-300;window.open($(this).attr("href"),"popupWindow","width=1000,height=700,top="+t+", left="+a+",scrollbars=yes")})}(jQuery);
},{"./utils/index":"jWsf"}]},{},["PGfa"], null)
//# sourceMappingURL=/PatientDashboardController.js.map